<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Formazioni Drag & Drop</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    display: flex;
    height: 100vh;
  }
  #field {
    flex: 2;
    background: url('campo.jpg') no-repeat center center;
    background-size: cover;
    position: relative;
  }
  .role {
    position: absolute;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: rgba(255,255,255,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    cursor: pointer;
  }
  #playersList {
    flex: 1;
    background: #f2f2f2;
    padding: 20px;
    overflow-y: auto;
  }
  .playerItem {
    padding: 8px 12px;
    background: white;
    border-radius: 8px;
    margin-bottom: 8px;
    cursor: grab;
  }
  .playerItem.dragging {
    opacity: 0.5;
  }
  select {
    margin-bottom: 10px;
    padding: 6px;
    width: 100%;
  }
</style>
</head>
<body>

<div id="field"></div>

<div id="playersList">
  <select id="teamSelect">
    <option value="TeamA">Team A</option>
    <option value="TeamB">Team B</option>
  </select>
  <div id="list"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
<script>
// Dati demo giocatori
const teams = {
  TeamA: ["Portiere A","Difensore A1","Difensore A2","Centrocampista A1","Centrocampista A2","Attaccante A1","Attaccante A2"],
  TeamB: ["Portiere B","Difensore B1","Difensore B2","Centrocampista B1","Centrocampista B2","Attaccante B1","Attaccante B2"]
};

// Coordinate demo modulo 4-4-2 (%)
const formation = {
  GK:[85,45], LB:[70,15], CB1:[70,35], CB2:[70,55], RB:[70,75],
  LM:[55,20], CM1:[55,40], CM2:[55,60], RM:[55,80],
  ST1:[30,35], ST2:[30,55]
};

const field = document.getElementById('field');

// Crea pedine ruolo
Object.keys(formation).forEach(role=>{
  const div = document.createElement('div');
  div.classList.add('role');
  div.id = role;
  div.textContent = role;
  const [top,left] = formation[role];
  div.style.top = top + '%';
  div.style.left = left + '%';
  field.appendChild(div);
});

// Mostra lista giocatori
const listContainer = document.getElementById('list');
const teamSelect = document.getElementById('teamSelect');

function updateList(){
  const team = teamSelect.value;
  listContainer.innerHTML = '';
  teams[team].forEach(player=>{
    const div = document.createElement('div');
    div.classList.add('playerItem');
    div.textContent = player;
    listContainer.appendChild(div);
  });
}

teamSelect.addEventListener('change', updateList);
updateList();

// Drag & drop con interact.js
interact('.playerItem').draggable({
  inertia: true,
  autoScroll: true,
  onmove: dragMoveListener,
  onend: event => { event.target.style.transform = 'translate(0,0)'; }
});

function dragMoveListener (event) {
  const target = event.target;
  const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
  const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
  target.style.transform = `translate(${x}px, ${y}px)`;
  target.setAttribute('data-x', x);
  target.setAttribute('data-y', y);
}

// Pedine accettano drop
Object.keys(formation).forEach(role=>{
  interact('#'+role).dropzone({
    accept: '.playerItem',
    overlap: 0.7,
    ondrop: event=>{
      const roleDiv = event.target;
      roleDiv.textContent = event.relatedTarget.textContent;
      // reset del draggable
      event.relatedTarget.style.transform = 'translate(0,0)';
    }
  });
});
</script>

</body>
</html>
